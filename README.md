# MySobes_fastAPI

### Описание:

Очередная моя попытка создать приложение для собственного использования. Это приложение, где вы можете создать список открытых вопросов и затем попробовать пройти тестирование по этим вопросам.

### Серверная часть

Фреймворк fastAPI  
Запуск приложения через  main.py  
команда запуска: `uvicorn main:app --reload`

### Клиентская часть

Написана на React  
Запуск клиентской части: `npm run dev`

### Использование

1. Скачиваем репозиторий
2. Устанавливаем python3.10
3. В папке проекта создаем виртуальное окружение: `python3.10 -m venv venv`
4. Активируем виртуальную среду: `source venv/bin/activate`
5. Устанавливаем зависимости: `pip install -r requirements.txt`
6. Накатываем миграции `alembic upgrade head`
7. Запускаем сервер: `cd server`, `uvicorn main:app --reload`
8. Переходим в директорию клиента и запускаем клиент: `npm run dev`

---

## Дневник разработчика

### TODO server сonfig side:

- Написать тесты API компонентов
- Добавить авторизацию/аутентификацию

### TODO server project side:

- Таблица собес-контейнера
- Добавить функцию сборки собес-контейнера
- Отправка контейнера клиенту
- Загрузка результата от клиента

### TODO client:

- Добавить возможность добавлять/редактировать/удалять вопрос и тему (будем это делать через модальное окно на странице дерева вопросов)
- Страница списка собес контейнеров
- Страница Экзамена + таймер
- Страница оценки результатов + отправка результатов на сервер
- Страница просмотра результатов

### TODO beauty:

- Настроить стили для отображения списка тем и вопросов
  - ~~Настроить отображение тем и вопросов в виде дерева~~
  - ~~Настроить подсветку при наведении мыши~~ (как оказалось, это делается просто в css)
  - Стили модального окна QuestionInfo
  - \*настроить анимацию details(Сложная задача со звездочкой) https://css-tricks.com/how-to-animate-the-details-element/

### Просто идеи

Есть еще идея при изменении вопроса создавать просто новую версию этого вопроса и сохранять историю изменений этого вопроса.
Также у каждого вопроса будет средний показатель успешности ответа на этот вопрос. При изменении вопроса, последняя версия будет отображаться в общем списке. При нажатии на вопрос будет отображаться страница

Появилась идея, добавить к вопросам дополнительные "направляющие вопросы" которые могут быть подсказками во время экзамена. Для этого нужно создать дополнительную таблицу (id, question_id, sub_question - один ко многим).  
Еще вопрос, стоит ли при запросе /topics отправлять к списко вопросов answer? Мне кажется лучше будет, если все доп вопросы и answer клиент будет запрашивать в момент нажатия на вопрос из списка.

Определенно, в моем приложении будет поддержка markdown! тем более я выяснил, что на react это делается просто.

## Короче ближайшие задачи:

- Добавить возможность с фронта создавать тему и вопрос(07-... .05.24)
  - ~~настроить модальные окна~~ (07.05.24)
  - ~~Настроить отображение списка input для выбора родительской темы~~ (08.05.24)
  - ~~Настройка текстовых полей и валидация~~ (08.05.24)
  - ~~Настроить отправку данных на сервер~~ (08.05.24)
  - Настроить отображение сообщения об успешности и ошибке валидации пользователю
  - ~~Сделать тоже самое для createQuestion~~ (10.05.24)
- Добавить возможность редактировать вопрос и тему
  - Для редактирования вопроса уже есть кнопка, нужно модальное окно
  - Для редактирования темы нужна кнопка и модальное окно

---

- Написать функцию сборки собесов + таблицу для таких контейнеров
- Отображение списка контейнеров и статусов
- Страница экзамена
- Отправка результатов тестирования на сервер
- Завернуть в докер и задеплоить
- написать все тоже самое на elixir

---

## История коммитов

**Коммит от 05.05.24:**

- Добавил на фронтенде кнопки для вывода модального окна вопроса и кнопку редактирования справа от вопроса. Подредачил немного стили, стало красивее.

**Коммиты от 06.05.24:**

- Настроил миграции.
- Сделал поле topic_id обязательным для таблицы question
- Добавил код 404 для get_by_id
- Начал работать над клиентской возможностью добавлять вопрос или тему. Идея: создать модальное окно с селектом "создать тему" или "создать вопрос"

**Коммит от 07.05.24:**

- Настроил стиль модального окна AddItem
- Настроил селектор (создать тему или создать вопрос) чтобы он выглядел красиво
  _(На самом деле работа с клиентской стороной отнимает много времени, я попробую так не заморачиваться со стилем и постараюсь поскорее закончить с функцией создания темы и создания вопроса. Но все-таки нужно корректно отображать дерево тем для выбора parent темы вопроса или подтемы, это скорее всего отнимет много времени, возможно весь день 08.05.24. И это стремно капец)_

**Коммиты от 08.05.24:**

- Настроил отображение селектора родительских тем в CreateTopic.jsx. Но не получилось адеватно настроить стили отображения дерева в селекторе. Я скорее всего оставлю так и перейду к следующей задаче.
- Почти настроил отображение остальных элементов для CreateTopic.jsx
- Настроил корректный прием данных POST запроса на сервер.
- Почти закончил со стилями CreateTopicComponent. Осталось только отображать пользователю, что тема была создана успешно и отчищать поле ввода названия темы.  
  _Для меня решение проблемы с кодом 422 стало маленькой победой, потому что я долго ломал голову над ней._  
  _Сначала я просто не понимал, почему POST запрос возвращает 422. Я проверил отправляемые значения и посмотрел логи_  
  _По логам было видно, что сервер не находит поле "name", что казалось странным_
  _Мы, на пару с GPT ни как не могли понять в чем дело. Я полез на сайты и обшерстил с 10ок вопросов на stackowerflow_  
  _Я переделал запрос из json-body в url запрос и удивительно запрос оказался успешным_  
  _Стало понятно где искать и что спрашивать. В итоги выяснилось, что дело было в спецификации router-функции на стороне сервера_ `topic: Annotated[STopicAdd, Depends(STopicAdd)],` _вместо_ `topic: STopicAdd = Body(...)`  
  _Главное - будь я менее опытным, я скорее всего отправлял бы запросы с client в виде url запросов и думал бы, что так и должно быть. Но сейчас, на опыте я понимаю, как это не удобно и знаю, что в правильном мире должен быть способ корректно составлять запрос._

**10.05.24**

- Закончил с версткой и функциональной частьюсоздания тем и вопросов.
  _Появилось ощущение, что верстать и писать функционал на фронтенде - это просто болото, от которого нужно уже отказываться. Я вдруг понял, как много важных задач лежит на бэкенде. Да и кроме того, я ведь хотел еще сделать все тоже самое на elixir._
  _Думаю, мне уже хватит работать со стилями. На клиенте сосредоточусь чисто на функционале и отдам преоритет бекенду_

## История выполненных задач:

(06.05.24) ~~Настроить миграции~~
